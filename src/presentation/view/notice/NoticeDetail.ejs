<!DOCTYPE html>
<html lang="ko">

    <head>
        <% const pageTitle=`${notice.title} - SKKU 순수미술동아리 갤러리`; const
            additionalStyles=['/css/notice/NoticeDetail.css']; %>
            <%- include('../common/head', { pageTitle, additionalStyles }) %>
    </head>

    <body>
        <%- include('../common/header') %>

            <main class="notice-detail-page">
                <div class="notice-detail-container">
                    <!-- 공지사항 헤더 -->
                    <div class="notice-detail-header">
                        <% if (notice.is_important) { %>
                            <span class="notice-badge important">중요</span>
                            <% } %>
                                <h1 class="notice-detail-title">
                                    <%= notice.title %>
                                </h1>
                                <div class="notice-meta">
                                    <span class="notice-author">
                                        <%= notice.author %>
                                    </span>
                                    <span class="notice-date">
                                        <%= notice.created_at %>
                                    </span>
                                    <span class="notice-views">조회수 <%= notice.views %></span>
                                </div>
                    </div>

                    <!-- 공지사항 본문 -->
                    <div class="notice-detail-content">
                        <!-- 이미지 갤러리 (이미지가 있는 경우) -->
                        <% if (notice.images && notice.images.length> 0) { %>
                            <div class="notice-images">
                                <% notice.images.forEach((image, index)=> { %>
                                    <div class="notice-image-wrapper">
                                        <img src="<%= image %>" alt="공지사항 이미지 <%= index + 1 %>" class="notice-image">
                                    </div>
                                    <% }); %>
                            </div>
                            <% } %>

                                <!-- 본문 내용 -->
                                <div class="notice-content">
                                    <%- notice.detailContent %>
                                </div>
                    </div>

                    <!-- 이전/다음 글 네비게이션 -->
                    <nav class="notice-navigation">
                        <a href="/notice/<%= notice.prevId %>" class="btn--nav btn--prev" <%=!notice.prevId
                            ? 'style="display: none;"' : '' %>>
                            <i class="fas fa-chevron-left"></i>
                        </a>
                        <a href="/notice" class="btn--list">
                            <i class="fas fa-list"></i>
                            <span>목록으로</span>
                        </a>
                        <a href="/notice/<%= notice.nextId %>" class="btn--nav btn--next" <%=!notice.nextId
                            ? 'style="display: none;"' : '' %>>
                            <i class="fas fa-chevron-right"></i>
                        </a>
                    </nav>
                </div>

                <!-- 댓글 섹션 -->
                <div class="comments-container">
                    <div class="comments">
                        <div class="comments__header">
                            <h2 class="comments__title">댓글</h2>
                            <span class="comments__count">총 <%= pagination.totalItems %>개의 댓글</span>
                        </div>

                        <% if (user) { %>
                            <form class="comment-form">
                                <div class="comment-form__input-wrapper">
                                    <textarea class="comment-form__input" placeholder="댓글을 작성해주세요..."></textarea>
                                    <div class="comment-form__actions">
                                        <button type="button" class="btn btn--comment btn--comment-clear btn--delete"
                                            aria-label="댓글 내용 초기화">
                                            <i class="fas fa-trash-alt"></i>
                                        </button>
                                        <button type="submit" class="btn btn--comment btn--comment-submit"
                                            aria-label="댓글 작성">
                                            <i class="fas fa-paper-plane"></i>
                                        </button>
                                    </div>
                                </div>
                            </form>
                            <% } else { %>
                                <div class="comments__empty">
                                    <p>아직 댓글이 없습니다. 첫 댓글을 작성해보세요!</p>
                                </div>
                                <% } %>

                                    <div class="comments__list">
                                        <% if (comments && comments.length> 0) { %>
                                            <% comments.forEach(comment=> { %>
                                                <div class="comment">
                                                    <div class="comment__actions">
                                                        <button class="btn btn--action"
                                                            data-comment-id="<%= comment.id %>" title="댓글 수정">
                                                            <i class="fas fa-edit"></i>
                                                        </button>
                                                        <button class="btn btn--action btn--delete"
                                                            data-comment-id="<%= comment.id %>" title="댓글 삭제">
                                                            <i class="fas fa-trash-alt"></i>
                                                        </button>
                                                    </div>
                                                    <div class="comment__author">
                                                        <%= comment.author %>
                                                    </div>
                                                    <div class="comment__date">
                                                        <%= comment.formattedDate %>
                                                    </div>
                                                    <div class="comment__content">
                                                        <%= comment.content %>
                                                    </div>
                                                </div>
                                                <% }); %>
                                                    <% } %>
                                    </div>

                                    <div class="comments__pagination">
                                        <%- include('../common/pagination', { pagination: pagination,
                                            baseUrl: '?commentPage=' }) %>
                                    </div>
                    </div>
                </div>
            </main>

            <%- include('../common/footer') %>

                <!-- 외부 스크립트 파일 로드 -->
                <script src="/js/page/notice/NoticeDetail.js"></script>
    </body>

</html>
