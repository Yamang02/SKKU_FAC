<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title><%= artwork.title %> - SKKU Faculty Art Gallery</title>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <link rel="stylesheet" href="/css/style.css">
</head>
<body>
    <%- include('partials/header') %>

    <main class="artwork_detail_page">
        <div class="artwork_detail_container">
            <!-- 작품 이미지 섹션 -->
            <section class="artwork_image_section">
                <div class="artwork_image_wrapper">
                    <img src="<%= artwork.image %>" alt="<%= artwork.title %>" class="artwork_main_image">
                </div>
            </section>

            <!-- 작품 정보 섹션 -->
            <section class="artwork_info_section">
                <div class="artwork_detail_header">
                    <h1 class="artwork_detail_title"><%= artwork.title %></h1>
                    <p class="artwork_detail_artist"><%= artwork.artist %></p>
                    <p class="artwork_detail_department"><%= artwork.department %></p>
                </div>

                <div class="artwork_details">
                    <div class="detail_group">
                        <h2><i class="fas fa-info-circle icon_margin"></i>작품 정보</h2>
                        <div class="detail_item">
                            <span class="label">제작 연도</span>
                            <span class="value"><%= artwork.year %></span>
                        </div>
                        <div class="detail_item">
                            <span class="label">매체</span>
                            <span class="value"><%= artwork.medium %></span>
                        </div>
                        <div class="detail_item">
                            <span class="label">크기</span>
                            <span class="value"><%= artwork.size %></span>
                        </div>
                    </div>

                    <div class="detail_group">
                        <h2><i class="fas fa-align-left icon_margin"></i>작품 설명</h2>
                        <p class="artwork_description"><%= artwork.description %></p>
                    </div>

                    <div class="detail_group">
                        <h2><i class="fas fa-calendar-alt icon_margin"></i>전시 정보</h2>
                        <p class="exhibition_info"><%= artwork.exhibition %></p>
                    </div>
                </div>
            </section>
        </div>

        <!-- 댓글 섹션 -->
        <div class="comments_container">
            <div class="comments_section">
                <div class="comments_header">
                    <h2 class="comments_title">댓글</h2>
                    <span class="comment_count">총 <%= commentPagination.totalComments %>개의 댓글</span>
                </div>
                
                <form class="comment_form">
                    <div class="comment_input_wrapper">
                        <textarea class="comment_input" placeholder="댓글을 작성해주세요..."></textarea>
                        <div class="comment_actions_wrapper">
                            <button type="button" class="clear_comment" aria-label="댓글 내용 초기화">
                                <i class="fas fa-trash-alt"></i>
                            </button>
                            <button type="submit" class="submit_comment" aria-label="댓글 작성">
                                <i class="fas fa-paper-plane"></i>
                            </button>
                        </div>
                    </div>
                </form>

                <div class="comments_list">
                    <% if (comments && comments.length > 0) { %>
                        <% comments.forEach(comment => { %>
                            <div class="comment_item">
                                <div class="comment_actions">
                                    <button class="comment_action_btn edit_btn" data-comment-id="<%= comment.id %>" title="댓글 수정">
                                        <i class="fas fa-edit"></i>
                                    </button>
                                    <button class="comment_action_btn delete_btn" data-comment-id="<%= comment.id %>" title="댓글 삭제">
                                        <i class="fas fa-trash-alt"></i>
                                    </button>
                                </div>
                                <div class="comment_author"><%= comment.author %></div>
                                <div class="comment_date"><%= comment.formattedDate %></div>
                                <div class="comment_content"><%= comment.content %></div>
                            </div>
                        <% }); %>
                    <% } else { %>
                        <div class="no_comments">
                            <p>아직 댓글이 없습니다. 첫 댓글을 작성해보세요!</p>
                        </div>
                    <% } %>
                </div>

                <%- include('partials/pagination', { pagination: commentPagination, baseUrl: '?commentPage=' }) %>
            </div>
        </div>

        <!-- 관련 작품 섹션 -->
        <div class="related_artworks_wrapper">
            <div class="related_artworks">
                <div class="related_artworks_container">
                    <div class="related_artworks_header">
                        <h2 class="related_artworks_title">다른 작품</h2>
                    </div>
                    <div class="related_artworks_list">
                        <% if (relatedArtworks && relatedArtworks.length > 0) { %>
                            <% relatedArtworks.forEach(relatedArtwork => { %>
                                <div class="related_artwork_card">
                                    <a href="/artwork/<%= relatedArtwork.id %>">
                                        <div class="artwork_image_placeholder">
                                            <img src="<%= relatedArtwork.image || '/images/default-artwork.svg' %>" 
                                                alt="<%= relatedArtwork.title || '작품 이미지' %>" 
                                                class="related_artwork_image"
                                                onerror="this.src='/images/default-artwork.svg'">
                                        </div>
                                        <div class="related_artwork_info">
                                            <h3 class="related_artwork_title"><%= relatedArtwork.title || '제목 없음' %></h3>
                                            <p class="related_artwork_artist"><%= relatedArtwork.artist || '작가미상' %></p>
                                        </div>
                                    </a>
                                </div>
                            <% }); %>
                        <% } else { %>
                            <div class="empty_state">
                                <i class="fas fa-image"></i>
                                <p>관련된 다른 작품이 없습니다.</p>
                            </div>
                        <% } %>
                    </div>
                    <div class="list_action">
                        <div class="action_group">
                            <button class="scroll_btn prev_btn" aria-label="이전 작품">
                                <i class="fas fa-chevron-left"></i>
                            </button>
                            <a href="/artwork/list" class="back_to_list">
                                <i class="fas fa-th-large icon_margin"></i>
                                <span>작품 목록</span>
                            </a>
                            <button class="scroll_btn next_btn" aria-label="다음 작품">
                                <i class="fas fa-chevron-right"></i>
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <%- include('partials/footer') %>

    <!-- 외부 스크립트 파일 로드 -->
    <script src="/js/artwork-detail.js"></script>
</body>
</html>